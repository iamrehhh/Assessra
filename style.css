/* GLOBAL FONT */
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&display=swap');
/* NEW FONTS (For Formula Sheet) */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@600;700&display=swap');

:root {
    --lime-primary: #32CD32;
    --lime-dark: #228B22;
    --lime-light: #F0FFF0;
    --glass-bg: rgba(255, 255, 255, 0.95);
    --text-dark: #1a1a1a;
    --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
    --danger: #dc2626; 
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: 'Plus Jakarta Sans', sans-serif;
    background: linear-gradient(135deg, #f6fff6 0%, #e8f5e9 100%);
    color: var(--text-dark);
    min-height: 100vh;
    overflow-x: hidden; /* Prevents side scroll when menus are open */
}

.container { max-width: 1200px; margin: 0 auto; padding: 20px; }

/* === LOGIN SCREEN (Fix: Z-Index increased to 9999 to cover menus) === */
.login-screen { 
    position: fixed; 
    top: 0; 
    left: 0; 
    width: 100%; 
    height: 100%; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    background: rgba(255, 255, 255, 0.95); 
    backdrop-filter: blur(10px); 
    z-index: 9999; /* HIGHEST PRIORITY */
}
.login-card { background: white; padding: 50px; width: 400px; border-radius: 24px; box-shadow: var(--shadow); text-align: center; border: 1px solid var(--lime-light); }
.login-input { width: 100%; padding: 15px; margin: 10px 0; border-radius: 12px; border: 2px solid #eee; font-size: 1rem; transition: 0.3s; }
.login-input:focus { border-color: var(--lime-primary); outline: none; }

/* === APP HEADER === */
.app-header { display: flex; justify-content: space-between; align-items: center; background: var(--glass-bg); padding: 20px 30px; border-radius: 20px; margin-bottom: 30px; border: 1px solid white; box-shadow: var(--shadow); }
.header-left { display: flex; align-items: center; }
.app-logo { height: 45px; width: auto; margin-right: 15px; }

.nav-btn { background: transparent; border: none; font-weight: 700; color: #666; padding: 10px 20px; cursor: pointer; transition: 0.3s; font-size: 1rem; }
.nav-btn.active { color: var(--lime-dark); background: var(--lime-light); border-radius: 10px; }

/* === PAPERS GRID === */
.series-header { margin: 40px 0 20px 0; border-bottom: 2px solid #eee; padding-bottom: 10px; display: flex; align-items: baseline; gap: 15px; }
.year-big { font-size: 2rem; font-weight: 800; color: #ccc; }
.series-name { font-size: 1.4rem; font-weight: 700; color: var(--lime-dark); }
.papers-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
.paper-card { background: white; padding: 25px; border-radius: 18px; cursor: pointer; transition: 0.3s; border: 2px solid transparent; box-shadow: 0 4px 15px rgba(0,0,0,0.03); }
.paper-card:hover { border-color: var(--lime-primary); transform: translateY(-5px); }
.paper-tag { display: inline-block; padding: 5px 10px; background: var(--lime-light); color: var(--lime-dark); border-radius: 8px; font-size: 0.8rem; font-weight: 700; margin-bottom: 10px; }

/* === SIDE MENUS (Fix: Using Transform + 50% Width) === */
.side-menu-overlay { 
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
    background: rgba(0,0,0,0.4); z-index: 4000; opacity: 0; 
    pointer-events: none; transition: 0.3s ease; 
}
.side-menu-overlay.active { opacity: 1; pointer-events: auto; }

.side-menu { 
    position: fixed; 
    top: 0; 
    width: 50vw; /* 50% WIDTH */
    min-width: 320px;
    height: 100vh; 
    background: white; 
    z-index: 4001; 
    box-shadow: 0 0 30px rgba(0,0,0,0.15); 
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
    overflow-y: auto; 
    display: flex; 
    flex-direction: column; 
    
    /* Default: Right Side Menu (Hidden) */
    right: 0;
    transform: translateX(100%); 
}

.side-menu.active { 
    transform: translateX(0); 
}

/* Left Side Menu (Scorecard/Leaderboard) */
.side-menu.left-side {
    right: auto;
    left: 0;
    border-right: 1px solid #ddd;
    /* Default: Hidden to the left */
    transform: translateX(-100%);
}

.side-menu.left-side.active {
    transform: translateX(0);
}

.menu-header { padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
.menu-close { background: transparent; border: none; font-size: 1.5rem; cursor: pointer; color: #888; transition: 0.2s; }
.menu-close:hover { color: #dc2626; transform: scale(1.1); }

/* Accordion Subjects */
.subject-group { border-bottom: 1px solid #f5f5f5; }
.subject-btn { width: 100%; text-align: left; padding: 18px 20px; background: white; border: none; font-size: 1.1rem; font-weight: 800; color: #333; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
.subject-btn:hover { background: #fafafa; color: var(--lime-dark); }
.subject-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: #fafafa; }
.subject-content.expanded { max-height: 600px; }

.paper-link { display: block; padding: 12px 20px 12px 40px; color: #666; text-decoration: none; cursor: pointer; font-weight: 600; border-left: 3px solid transparent; transition: 0.2s; }
.paper-link:hover, .paper-link.active { background: #f0f0f0; color: var(--lime-dark); border-left-color: var(--lime-primary); }

/* === SCORECARD SUBSECTIONS === */
.paper-subsection-title { background: #eee; padding: 8px 20px; font-size: 0.85rem; font-weight: 700; color: #666; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid #ddd; border-top: 1px solid #fff; }
.total-link { background: #f0fdf4 !important; border-left: 4px solid var(--lime-primary) !important; color: var(--lime-dark) !important; }

/* === WORKSPACE & EXTRAS === */
.workspace { display: grid; grid-template-columns: 1fr 1.2fr; gap: 30px; height: 85vh; }
.insert-panel { background: #333; border-radius: 20px; overflow: hidden; box-shadow: var(--shadow); height: 100%; position: relative; transition: all 0.3s ease; }
.insert-pdf-frame { width: 100%; height: 100%; border: none; }
.insert-panel.fullscreen { position: fixed; top: 5vh; left: 5vw; width: 90vw; height: 90vh; z-index: 2000; box-shadow: 0 0 100px rgba(0,0,0,0.5); border: 5px solid white; }
.maximize-insert-btn { position: absolute; top: 15px; right: 15px; z-index: 10; background: rgba(255, 255, 255, 0.9); border: none; border-radius: 8px; padding: 8px 15px; cursor: pointer; font-weight: 700; font-size: 0.9rem; box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: 0.2s; color: #333; }
.questions-panel { overflow-y: auto; padding-right: 10px; height: 100%; }
.question-card { background: white; padding: 30px; border-radius: 20px; margin-bottom: 25px; box-shadow: 0 4px 10px rgba(0,0,0,0.02); border: 1px solid #f0f0f0; }
.q-header { display: flex; justify-content: space-between; margin-bottom: 15px; }
.q-badge { background: var(--lime-dark); color: white; padding: 5px 12px; border-radius: 20px; font-weight: 700; font-size: 0.9rem; }
textarea { width: 100%; min-height: 200px; padding: 15px; border: 2px solid #eee; border-radius: 12px; margin: 15px 0 5px 0; font-family: inherit; font-size: 1rem; resize: vertical; transition: 0.3s; }
textarea:focus { border-color: var(--lime-primary); outline: none; }
textarea.expanded { min-height: 500px; border-color: var(--lime-dark); box-shadow: 0 0 15px rgba(50, 205, 50, 0.1); }
.expand-btn { background: #f0f0f0; border: none; padding: 5px 10px; border-radius: 5px; color: #333; font-size: 0.8rem; font-weight: 600; cursor: pointer; margin-bottom: 5px; transition: 0.2s; float: right; }
.word-count { font-size: 0.85rem; color: #888; text-align: right; margin-bottom: 15px; font-weight: 600; }
.word-count.bad { color: var(--danger); }
.word-count.good { color: var(--lime-dark); }
.submit-btn { background: linear-gradient(135deg, var(--lime-primary) 0%, var(--lime-dark) 100%); color: white; border: none; padding: 12px 30px; border-radius: 50px; font-weight: 700; cursor: pointer; transition: 0.3s; width: 100%; box-shadow: 0 4px 15px rgba(50, 205, 50, 0.3); font-size: 1rem; }
.feedback-box { margin-top: 20px; background: var(--lime-light); padding: 20px; border-radius: 16px; border: 1px solid var(--lime-primary); }
.model-ans-box { background: #1a1a1a; color: #f0f0f0; padding: 15px; border-radius: 10px; margin-top: 15px; font-size: 0.95rem; line-height: 1.6; white-space: pre-wrap; }
.hidden { display: none !important; }
.toggle-insert { display: none; margin-bottom: 15px; background: #eee; padding: 10px; text-align: center; border-radius: 10px; cursor: pointer; }
@media (max-width: 900px) { .workspace { grid-template-columns: 1fr; height: auto; } .insert-panel { display: none; height: 400px; } .insert-panel.show { display: block; } .toggle-insert { display: block; } }

/* === SCORECARD STYLES === */
.score-row { display: flex; justify-content: space-between; padding: 15px; border-bottom: 1px solid #eee; font-size: 1rem; }
.total-card { background: linear-gradient(135deg, #0f172a 0%, #334155 100%); color: white; padding: 40px; border-radius: 20px; margin-top: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
.modern-table { width: 100%; border-collapse: separate; border-spacing: 0 15px; margin-top: 10px; }
.modern-table thead th { color: #888; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px; padding: 0 20px 10px 20px; border: none; background: transparent; text-align: left; }
.modern-table tbody tr { background: white; box-shadow: 0 5px 20px rgba(0,0,0,0.03); }
.modern-table td { padding: 20px; border: none; }
.modern-table td:first-child { border-top-left-radius: 15px; border-bottom-left-radius: 15px; }
.modern-table td:last-child { border-top-right-radius: 15px; border-bottom-right-radius: 15px; text-align: right; }
.score-badge { background: var(--lime-light); color: var(--lime-dark); padding: 8px 16px; border-radius: 30px; font-weight: 800; font-size: 1rem; border: 1px solid var(--lime-primary); }

/* === FORMULA/DEF STYLES === */
.formula-section, .def-section { margin-bottom: 40px; }
.chapter-title, .topic-title { font-family: 'Playfair Display', serif; font-size: 1.6rem; color: #1a1a1a; margin-bottom: 20px; border-bottom: 2px solid var(--lime-primary); padding-bottom: 5px; display: inline-block; }
.formula-grid, .def-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
.formula-card, .def-card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); border: 1px solid rgba(0,0,0,0.05); transition: transform 0.2s ease; position: relative; overflow: hidden; }
.formula-card:hover, .def-card:hover { transform: translateY(-3px); border-color: var(--lime-primary); }
.formula-card::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: var(--lime-primary); }
.def-card::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: #3b82f6; }
.f-title, .d-term { font-family: 'Inter', sans-serif; font-size: 0.85rem; font-weight: 600; color: #888; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; }
.d-term { font-size: 1.1rem; color: #1e293b; font-family: 'Playfair Display', serif; font-weight: 700; }
.f-body, .d-desc { font-family: 'Inter', sans-serif; font-size: 1.15rem; font-weight: 500; color: #2c3e50; line-height: 1.4; }
.d-desc { font-size: 0.95rem; font-weight: 400; color: #475569; line-height: 1.6; }

/* === CHAT & UNREAD === */
.unread-badge { position: absolute; top: 5px; right: 5px; width: 12px; height: 12px; background-color: #ef4444; border-radius: 50%; border: 2px solid white; }
.unread-badge.hidden { display: none; }
.hamburger-btn { background: transparent; border: none; font-size: 1.8rem; cursor: pointer; color: #666; margin-left: 15px; vertical-align: middle; transition: 0.3s; }
.hamburger-btn:hover { color: var(--lime-dark); }
.chat-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 2999; transition: opacity 0.3s ease; }
.chat-overlay.hidden { opacity: 0; pointer-events: none; }
.chat-panel { position: fixed; top: 0; right: -100%; width: 400px; height: 100vh; background: white; box-shadow: -5px 0 25px rgba(0,0,0,0.1); z-index: 3000; transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1); display: flex; flex-direction: column; }
.chat-panel.open { right: 0; }
@media (max-width: 768px) { .chat-panel { width: 85vw; } }
.chat-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; display: flex; justify-content: space-between; align-items: center; }
.chat-messages { flex-grow: 1; padding: 20px; overflow-y: auto; background: #f8fafc; }
.chat-input-area { padding: 20px; background: white; border-top: 1px solid #eee; display: flex; gap: 10px; }
.chat-input-area input { flex-grow: 1; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; }
.chat-input-area input:focus { outline: none; border-color: var(--lime-primary); }

/* === TIPS === */
.tip-card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); border: 1px solid rgba(0,0,0,0.05); transition: transform 0.2s ease; position: relative; overflow: hidden; }
.tip-card:hover { transform: translateY(-3px); border-color: #FFD700; }
.tip-card::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: #FFD700; }
.t-topic { font-family: 'Inter', sans-serif; font-size: 0.85rem; font-weight: 700; color: #d4ac0d; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; }
.t-content { font-family: 'Plus Jakarta Sans', sans-serif; font-size: 0.95rem; color: #444; line-height: 1.6; }